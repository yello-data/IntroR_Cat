<!DOCTYPE html>
<html lang="ca" xml:lang="ca">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1.7 Importar arxius | R en Ciències Socials</title>
  <meta name="description" content="Aquest llibre té com a principal objectiu l’ensenyament d’R en línia als estudiants de Ciència Política i Relacions Internacionals." />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="1.7 Importar arxius | R en Ciències Socials" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Aquest llibre té com a principal objectiu l’ensenyament d’R en línia als estudiants de Ciència Política i Relacions Internacionals." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.7 Importar arxius | R en Ciències Socials" />
  
  <meta name="twitter:description" content="Aquest llibre té com a principal objectiu l’ensenyament d’R en línia als estudiants de Ciència Política i Relacions Internacionals." />
  

<meta name="author" content="Jordi Mas Elias" />


<meta name="date" content="2022-06-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="objects.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R en Ciències Socials</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prefaci</a></li>
<li class="chapter" data-level="1" data-path="guiarstudio.html"><a href="guiarstudio.html"><i class="fa fa-check"></i><b>1</b> Guia d’RStudio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1.1</b> Instal·lació</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="install.html"><a href="install.html#install-r"><i class="fa fa-check"></i><b>1.1.1</b> Instal·lació d’R</a></li>
<li class="chapter" data-level="1.1.2" data-path="install.html"><a href="install.html#install-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> Instal·lació d’RStudio</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="navigate.html"><a href="navigate.html"><i class="fa fa-check"></i><b>1.2</b> Orientació a RStudio</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="navigate.html"><a href="navigate.html#create-project"><i class="fa fa-check"></i><b>1.2.1</b> Crear un projecte</a></li>
<li class="chapter" data-level="1.2.2" data-path="navigate.html"><a href="navigate.html#create-script"><i class="fa fa-check"></i><b>1.2.2</b> Crear un Script</a></li>
<li class="chapter" data-level="1.2.3" data-path="navigate.html"><a href="navigate.html#four-windows"><i class="fa fa-check"></i><b>1.2.3</b> Les quatre finestres</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="packages.html"><a href="packages.html"><i class="fa fa-check"></i><b>1.3</b> Paquets</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="packages.html"><a href="packages.html#els-paquets-de-sèrie"><i class="fa fa-check"></i><b>1.3.1</b> Els paquets de sèrie</a></li>
<li class="chapter" data-level="1.3.2" data-path="packages.html"><a href="packages.html#new-packages"><i class="fa fa-check"></i><b>1.3.2</b> Instal·lació de nous paquets</a></li>
<li class="chapter" data-level="1.3.3" data-path="packages.html"><a href="packages.html#load-packages"><i class="fa fa-check"></i><b>1.3.3</b> Càrrega de paquets</a></li>
<li class="chapter" data-level="1.3.4" data-path="packages.html"><a href="packages.html#open-packages"><i class="fa fa-check"></i><b>1.3.4</b> Obertura d’un paquet</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="starwars.html"><a href="starwars.html"><i class="fa fa-check"></i><b>1.4</b> L’objecte Star Wars</a></li>
<li class="chapter" data-level="1.5" data-path="r-script.html"><a href="r-script.html"><i class="fa fa-check"></i><b>1.5</b> <em>Script</em></a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="r-script.html"><a href="r-script.html#order-script"><i class="fa fa-check"></i><b>1.5.1</b> Ordenació de l’<em>script</em></a></li>
<li class="chapter" data-level="1.5.2" data-path="r-script.html"><a href="r-script.html#script-rules"><i class="fa fa-check"></i><b>1.5.2</b> Regles bàsiques de l’<em>script</em></a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i><b>1.6</b> Els objectes</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="objects.html"><a href="objects.html#create-objects"><i class="fa fa-check"></i><b>1.6.1</b> Crear objectes</a></li>
<li class="chapter" data-level="1.6.2" data-path="objects.html"><a href="objects.html#consulta-reproducció-i-eliminació-dobjectes"><i class="fa fa-check"></i><b>1.6.2</b> Consulta, reproducció i eliminació d’objectes</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="import-files.html"><a href="import-files.html"><i class="fa fa-check"></i><b>1.7</b> Importar arxius</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="import-files.html"><a href="import-files.html#import-files-web"><i class="fa fa-check"></i><b>1.7.1</b> Importar des d’una web</a></li>
<li class="chapter" data-level="1.7.2" data-path="import-files.html"><a href="import-files.html#import-files-wd"><i class="fa fa-check"></i><b>1.7.2</b> Importació des del directori de treball</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>1.8</b> Resum</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referències.html"><a href="referències.html"><i class="fa fa-check"></i>Referències</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R en Ciències Socials</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="import-files" class="section level2 hasAnchor" number="1.7">
<h2><span class="header-section-number">1.7</span> Importar arxius<a href="import-files.html#import-files" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fins ara hem creat objectes de poc interès substantiu sobre la temàtica que estem estudiant. Encara que pugui ser apassionant viatjar per l’univers de <em>Star Wars</em>, la gràcia de crear objectes és, com hem esmentat anteriorment, aconseguir que continguin dades sobre temes que tinguin relació directa amb la nostra disciplina d’estudi. Això es fa mitjançant la importació d’arxius. El procediment habitual amb R serà el següent:</p>
<ol style="list-style-type: decimal">
<li><strong>Convertirem una base de dades en un objecte d’R.</strong> Per exemple, una base de dades de partits polítics, o de grups terroristes, o de bombardejos al Iemen.</li>
<li><strong>Treballarem l’objecte amb funcions.</strong> Les funcions ens permetran transformar les dades per tal que responguin les nostres preguntes.</li>
</ol>
<p>Les dades que ens interessen se solen trobar en arxius que tenen formats que probablement ens són familiars, com <code>.xlsx</code>, <code>.csv</code> o <code>.dta</code>. Per transformar aquestes dades en objecte d’R, les <strong>funcions d’importació</strong> tenen noms bastant intuïtius. Per exemple:</p>
<ul>
<li>Si volem llegir un arxiu <code>csv</code>, la funció serà habitualment <code>read_csv()</code>, que és al paquet <code>readr</code>.</li>
<li>Si volem llegir un arxiu <code>xlsx</code>, la funció serà habitualment <code>read_xlsx()</code>, que és al paquet <code>readxl</code>.</li>
</ul>
<div id="import-files-web" class="section level3 hasAnchor" number="1.7.1">
<h3><span class="header-section-number">1.7.1</span> Importar des d’una web<a href="import-files.html#import-files-web" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En algunes ocasions, importar un arxiu des d’una web pot ser la mar de senzill. Només ens caldrà conèixer l’adreça web on és, examinar de quin tipus d’arxiu es tracta, donar un nom a l’objecte i aplicar la funció que volem utilitzar. Per exemple:</p>
<ul>
<li>Web: <code>https://www.chesdata.eu/s/Candidate_Ukraine_2014.csv</code>.</li>
<li>Tipus d’arxiu: Veiem que és un arxiu <code>csv</code>.</li>
<li>Nom d’objecte: <code>ches</code>.</li>
<li>Funció: <code>read_csv()</code>.</li>
</ul>
<div class="alert alert-info">
<p><strong>Pas 14. Importar des de pàgina web</strong>: A continuació importarem un arxiu que és a la pàgina web de la <a href="https://www.chesdata.eu/">Chapel Hill Expert Survey (CHES)</a>. La funció que necessitem pertany al paquet <code>readr</code>, que haurem de tenir carregat si volem que ens funcioni:</p>
<pre><code>ches &lt;- read_csv(&quot;https://www.chesdata.eu/s/Candidate_Ukraine_2014.csv&quot;)</code></pre>
<p>És important remarcar que el nom de l’ubicació d’internet ha d’anar entre cometes. Un cop hem creat l’objecte <code>ches</code>, ja li podem aplicar algunes funcions com les que hem vist anteriorment.</p>
<pre><code>ches
glimpse(ches)
unique(ches$party_name)
hist(ches$lrgen)
plot(ches$lrgen, ches$galtan)</code></pre>
</div>
<p>Si el codi anterior ens ha funcionat és perquè tenim carregat el paquet <code>readr</code>, que conté la funció <code>read_csv()</code>. De la mateixa manera, si volem importar a R un arxiu d’Excel, necessitarem les funcions <code>read_xlsx()</code> o <code>read_xls()</code> del paquet readxl, que també haurem de tenir carregat. Aquestes i altres maneres d’importar arxius les resumim a la següent Taula <a href="import-files.html#tab:import">1.1</a><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>.</p>
<table>
<caption><span id="tab:import">Taula 1.1: </span>Tipus de funcions per importar arxius</caption>
<thead>
<tr class="header">
<th align="left">Tipus d’arxiu</th>
<th align="left">Paquet</th>
<th align="left">Funcions</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">csv</td>
<td align="left">readr</td>
<td align="left">read_csv() o read_csv2()</td>
</tr>
<tr class="even">
<td align="left">xls</td>
<td align="left">readxl</td>
<td align="left">read_xls()</td>
</tr>
<tr class="odd">
<td align="left">xlsx</td>
<td align="left">readxl</td>
<td align="left">read_xlsx()</td>
</tr>
<tr class="even">
<td align="left">dta</td>
<td align="left">foreign</td>
<td align="left">read.dta()</td>
</tr>
<tr class="odd">
<td align="left">dta</td>
<td align="left">haven</td>
<td align="left">read_dta()</td>
</tr>
<tr class="even">
<td align="left">sav</td>
<td align="left">haven</td>
<td align="left">read_sav()</td>
</tr>
<tr class="odd">
<td align="left">spss</td>
<td align="left">haven</td>
<td align="left">read_spss()</td>
</tr>
</tbody>
</table>
</div>
<div id="import-files-wd" class="section level3 hasAnchor" number="1.7.2">
<h3><span class="header-section-number">1.7.2</span> Importació des del directori de treball<a href="import-files.html#import-files-wd" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El més habitual, però, és que no sigui tan fàcil importar les dades directament d’internet. Normalment, el que haurem de fer serà entrar a la pàgina web on són les dades, descarregar l’arxiu al nostre ordinador, situar-lo al nostre directori de treball i importar-lo a R<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>.</p>
<p>Un aquest cas, l’únic que haurem de fer és assegurar-nos que tinguem l’arxiu en el <strong>directori de treball</strong> i posar el seu nom, entre cometes, a la funció d’importació.</p>
<pre><code>ches &lt;- read_csv(&quot;Candidate_Ukraine_2014.csv&quot;)`</code></pre>
<p>En el següent exercici descarregarem un arxiu d’Excel, el situarem al nostre directori de treball i el convertirem en un objecte d’R.</p>
<div class="alert alert-success">
<p><strong>Exercici 2. Importa els SDG</strong>: Volem treballar amb els Sustainable Development Goals (SDG), que es troben a la web de <a href="https://www.sdgindex.org/reports/sustainable-development-report-2021/">Sustainable Development Report</a>. A dins de la web, les dades són a la part dreta de la pantalla.</p>
<p><img src="img/sdg-web.png" style="width:70.0%" /></p>
<p>Descarregarem l’arxiu i ens assegurarem que estigui ubicat al nostre directori de treball.</p>
<p><img src="img/sdg-wd.png" style="width:70.0%" /></p>
<p>També podem consultar el contingut del nostre directori de treball amb la funció següent.</p>
<pre><code>dir()</code></pre>
<p>Finalment, com que tenim carregat el paquet <code>readxl</code>, transformarem l’arxiu d’Excel en un objecte d’R mitjançant la funció següent. Fixeu-vos que hem introduït l’argument <code>sheet = 4</code> a la funció. Aquests arguments ens serveixen per donar indicacions més detallades a les funcions. En aquest cas, estem precisant que les dades que ens interessen són a la quarta pestanya de l’arxiu d’Excel.</p>
<pre><code>sdg &lt;- read_xlsx(&quot;SDR 2021 - Database.xlsx&quot;, sheet = 4)</code></pre>
<p>Un cop hem creat l’objecte <code>sdg</code>, ja li podem aplicar algunes funcions.</p>
<pre><code>sdg
glimpse(sdg)
table(sdg$`Regions used for the SDG Index &amp; Dashboard`)
hist(sdg$`Press Freedom Index (best 0-100 worst)`)</code></pre>
</div>
<div class="alert alert-info">
<p><strong>Pas 15. Ordena el directori de treball:</strong> En alguns projectes, és possible que haguem de posar molts documents al nostre directori de treball. Una forma útil d’ordenar els arxius és utilitzar el sistema de carpetes habitual.</p>
<ol style="list-style-type: decimal">
<li>A la finestra Files, crearem una carpeta que es digui <code>Datasets</code>.</li>
</ol>
<p><img src="img/folder-datasets.png" style="width:40.0%" /></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Posarem l’arxiu <code>SDR 2021 - Database.xlsx</code> a dins la carpeta <code>Datasets</code>.</p></li>
<li><p>Inclourem <code>Datasets/</code> abans del nom de l’arxiu en la funció d’importació.</p></li>
</ol>
<pre><code>sdg &lt;- read_xlsx(&quot;Datasets/SDR 2021 - Database.xlsx&quot;, sheet = 4)</code></pre>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="9">
<li id="fn9"><p>Com observem a la taula, podem distingir dos tipus de funcions csv. La funció <code>read_csv()</code> importa els arxius que estan codificats en format americà, on la coma separa els valors i el punt indica els decimals, mentre que la funció <code>read_csv2()</code> importa els arxius codificats en format europeu, on el punt i coma és el separador i la coma indica els decimals.<a href="import-files.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Hi ha funcions com <code>download.file()</code> que ens permeten automatitzar la descàrrega d’arxius des d’internet. No obstant, és una funció que genera errors en alguns ordinadors, de manera que no l’aprendrem fins més endavant.<a href="import-files.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="objects.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-guiarstudio.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["intro-r-cat.pdf", "intro-r-cat.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
